---
title: "Nadal vs. Federer: Who Plays Faster?"
author: "Kevin Havis"
date: "2024-08-29"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Nadal vs. Federer: Who Plays Faster?

## Introduction

Who sets the pace when there's no clock? In tennis, it's the players who control the pace of the game. With no time limit on matches, only score, players must be tactical when considering their pace of play.

The article focuses on how the pace of play has changed over the years and on different surfaces, but let's look at something a bit different.

Let's compare the point duration for a classic rival pair; Rafael Nadal and Roger Federer.

[Article Link](https://fivethirtyeight.com/features/why-some-tennis-matches-take-forever/)

## Setting up the environment

```{r echo=FALSE}
install.packages("tidyverse")
```

```{r echo=FALSE}
library(dplyr)
library(ggplot2)
```

## Loading the Data

We'll load the `serve_times.csv` file from the Github repo, which contains data on how many second elapse between points for a given player's serve.

```{r}
# Load data from Github repo
serve_time <- read.csv("https://raw.githubusercontent.com/fivethirtyeight/data/master/tennis-time/serve_times.csv")

# Take an initial look at the data
glimpse(serve_time)
```

## Sub-sectioning the data

Let's subset the data to get the player's we're interested in; Nadal and Federer. We'll look at points both in and out of serve by creating a new feature `player` which will simply represent either of our players of interest involved in the point.

```{r}
# Create list of player's we'ere interested in
players_of_interest <- c('Rafael Nadal', 'Roger Federer')

# Create a "player" column and fill when either player was in the point
poi_point_time <- serve_time |> 
  mutate(player = ifelse(
          server == players_of_interest[1] | opponent == players_of_interest[1], 
          players_of_interest[1], 
            ifelse(
              server == players_of_interest[2] | opponent == players_of_interest[2], 
              players_of_interest[2], 
              NA
              )
            )
        ) |> 
          select(player, seconds_before_next_point) |> # We only neeed these columns now
          filter(player %in% players_of_interest)      # Filter for our players

# Take a quick look to confirm results are as expected
glimpse(poi_point_time)

```

## Visualize Point Time

In this exercise, we consider `player` to be our predictor variable, and `seconds_before_next_point` to be the independent variable.

Let's visualize the distribution of the data for each player to see if there's anything interesting.

```{r}

ggplot(poi_point_time, aes(x = player, y = seconds_before_next_point)) +
  geom_boxplot() +
  labs(x = "Player",
       y = "Seconds Before Next Point",
       title = "Distribution of Time Between Points, Nadal v. Federer")

```

We can see that for this sample, Nadal's time between is significantly longer than Federer's, with a median `seconds_before_next_point` of approximately 23 compared to Federer's 16.

## Conclusion

According to the data available, Federer generally plays faster points than Nadal.

For tennis fans, this makes intuitive sense given Federer's aggressive, fluid, and forward-moving play style. Nadal is known for playing topspin power shots and rallying from the baseline, so a longer point should be no surprise!

Admittedly, the sample size is small and limited to a few events. Additional data across a wider set of tournaments, surfaces, and players would make this a far more reasonable analysis and conclusion.
